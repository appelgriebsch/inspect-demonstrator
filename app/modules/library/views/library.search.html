<div layout="column" layout-fill ng-init="ctl.initialize()">
  <div flex layout="row" layout-fill layout-padding>
    <md-input-container layout-fill>
      <label>Search Term</label>
      <input ng-model="ctl.query" ng-keypress="ctl.search($event)" autofocus="autofocus">
    </md-input-container>
    <span flex></span>
    <md-button class="md-icon-button" ng-click="ctl.search($event)">
      <md-icon>send</md-icon>
    </md-button>
  </div>
  <md-grid-list md-cols-gt-lg="8" md-cols-gt-md="6" md-cols-gt-sm="2" md-cols-sm="1"
                md-gutter-gt-sm="6px" md-gutter-gt-md="12px"
                md-row-height-gt-md="1:1" md-row-height="4:3">
    <md-grid-tile md-colspan-sm="1" md-colspan="2" md-rowspan="1"
                  ng-repeat="item in ctl.items">
      <img ng-class="{ 'thumbnail': item.type === 'website', 'pagePrev': item.type === 'document' }" ng-src="{{ item.preview }}"></img>
      <md-grid-tile-footer ns-popover
                      ns-popover-template="itemMetadata"
                      ns-popover-trigger="mouseenter"
                      ns-popover-timeout="0.2"
                      ns-popover-popup-delay="0.7"
                      ns-popover-theme="ns-popover-tooltip-theme">
        <h3 class="filename">
          <a ng-if="item.type === 'website'" ui-sref="^.webview({ doc: item._id })">{{ item.title }}</a>
          <a ng-if="item.type === 'document'" ui-sref="^.pdfview({ doc: item._id })">{{ item.title }}</a>
        </h3>
      </md-grid-tile-footer>
    </md-grid-tile>
  </md-grid-list>
</div>
<script type="text/ng-template" id="itemMetadata">
  <div class="triangle"></div>
  <div class="ns-popover-tooltip">
    <div ng-if="item.author !== ''" layout="row" layout-fill>
      <h2>{{ item.author }}</h2>
      <span flex></span>
      <small>{{ item.publicationDate | date: 'short' }}</small>
    </div>
    <h3>{{ item.title }}</h3>
  </div>
</script>
